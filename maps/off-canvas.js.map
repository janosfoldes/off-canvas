{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/off-canvas.js"],"names":[],"mappings":"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","file":"../src/off-canvas.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// OFF-CANVAS\r\n// ==========\r\n\r\nconst attrClose           = 'data-close';\r\nconst attrOffCanvas       = 'data-off-canvas';\r\nconst attrOffCanvasButton = 'data-off-canvas-button';\r\nconst attrOffCanvasLock   = 'data-off-canvas-lock';\r\nconst attrToggler         = 'data-toggler';\r\nconst overlay             = $('<div class=\"canvas-overlay\"></div>');\r\nconst togglerClosed       = 'is-closed';\r\nconst togglerDefault      = 'is-active';\r\nconst togglerLocked       = 'is-locked';\r\nconst togglerNoAnim       = 'no-anim';\r\nconst togglerOpen         = 'is-open';\r\nconst togglerVisible      = 'is-visible';\r\n\r\n// Off-Canvas\r\n// ----------\r\n\r\nexport default class OffCanvas {\r\n    constructor(element) {\r\n        /* Initialize */\r\n        this._offCanvas = $(element);\r\n        this._button = $('#' + this._offCanvas.attr(attrOffCanvasButton));\r\n        this._buttonToggler = this._button.attr(attrToggler) || togglerDefault;\r\n\r\n        /* Initialize object to close */\r\n        let closeId = this._offCanvas.attr(attrClose);\r\n        this._closeEl = (closeId) ? document.getElementById(closeId) : undefined;\r\n\r\n        /* Locks */\r\n        this._locks = []\r\n        let lockIds = OffCanvas.stringToArray(this._offCanvas.attr(attrOffCanvasLock));\r\n        for (let i = 0; i < lockIds.length; i++) {\r\n            this._locks.push($('#' + lockIds[i]));\r\n        }\r\n\r\n        /* Refresh */\r\n        this.refresh();\r\n\r\n        /* Attach methods to the DOM Element of this off-canvas */\r\n        element.close = this.close.bind(this);\r\n        element.open = this.open.bind(this);\r\n\r\n        /* Events */\r\n        $(window).resize((e) => { this.onResize(e) });\r\n        overlay.on('click', (e) => { this.onOverlayClick(e) });\r\n        this._button.on('click', (e) => { this.onButtonClick(e) });\r\n    }\r\n\r\n    close() {\r\n        this.toggle(false);\r\n    }\r\n\r\n    onButtonClick(e) {\r\n        this._offCanvas.removeClass(togglerNoAnim);\r\n        this.toggle();\r\n    }\r\n\r\n    onOverlayClick(e) {\r\n        this.toggle(false);\r\n    }\r\n\r\n    onResize(e) {\r\n         this.refresh();\r\n    }\r\n\r\n    open() {\r\n        this.toggle(true);\r\n    }\r\n\r\n    refresh() {\r\n        this._offCanvas.addClass(togglerNoAnim);\r\n        let isButtonVisible = this._button.is(':visible');\r\n        if (isButtonVisible != this._isButtonVisible) { // State changed\r\n            this._offCanvas.toggleClass(togglerDefault, isButtonVisible);\r\n            this.toggle(false);\r\n            this._isButtonVisible = isButtonVisible;\r\n        }\r\n    }\r\n\r\n    static stringToArray(str) {\r\n        let a = [];\r\n        if (typeof str === 'string') {\r\n            str = str.trim();\r\n            if (str != '') {\r\n                a = (str.indexOf(',') > -1) ? str.split(/,/) : str.split(/ /);\r\n                for (let i=0; i < a.lenght; i++) a[i] = a[i].trim();\r\n            }\r\n        }\r\n        return a;\r\n    }\r\n\r\n    toggle(state) {\r\n        if (state == undefined) state = !this._offCanvas.hasClass(togglerOpen);\r\n        this._button.toggleClass(this._buttonToggler, state);\r\n        this._offCanvas.toggleClass(togglerOpen, state);\r\n        this._offCanvas.toggleClass(togglerClosed, !state);\r\n        overlay.toggleClass(togglerVisible, state);\r\n        if (state && this._closeEl != undefined) {\r\n            this._closeEl.close();\r\n        }\r\n        for (let i = 0; i < this._locks.length; i++) {\r\n            this._locks[i].toggleClass(togglerLocked, state)\r\n        }\r\n    }\r\n}\r\n\r\n// Initialize canvas overlay and elements with 'data-off-canvas' attribute\r\n// -----------------------------------------------------------------------\r\n\r\nlet offCanvases = [];\r\n$(document).ready(() => {\r\n    overlay.appendTo(document.body);\r\n    $('[' + attrOffCanvas + ']').each((index, item) => {\r\n        offCanvases.push(new OffCanvas(item));\r\n    });\r\n});\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvb2ZmLWNhbnZhcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUNBO0FBRUEsSUFBTSxTQUFTLEdBQWEsWUFBNUI7QUFDQSxJQUFNLGFBQWEsR0FBUyxpQkFBNUI7QUFDQSxJQUFNLG1CQUFtQixHQUFHLHdCQUE1QjtBQUNBLElBQU0saUJBQWlCLEdBQUssc0JBQTVCO0FBQ0EsSUFBTSxXQUFXLEdBQVcsY0FBNUI7QUFDQSxJQUFNLE9BQU8sR0FBZSxDQUFDLENBQUMsb0NBQUQsQ0FBN0I7QUFDQSxJQUFNLGFBQWEsR0FBUyxXQUE1QjtBQUNBLElBQU0sY0FBYyxHQUFRLFdBQTVCO0FBQ0EsSUFBTSxhQUFhLEdBQVMsV0FBNUI7QUFDQSxJQUFNLGFBQWEsR0FBUyxTQUE1QjtBQUNBLElBQU0sV0FBVyxHQUFXLFNBQTVCO0FBQ0EsSUFBTSxjQUFjLEdBQVEsWUFBNUIsQyxDQUVBO0FBQ0E7O0lBRXFCLFM7OztBQUNqQixxQkFBWSxPQUFaLEVBQXFCO0FBQUE7O0FBQUE7O0FBQ2pCO0FBQ0EsU0FBSyxVQUFMLEdBQWtCLENBQUMsQ0FBQyxPQUFELENBQW5CO0FBQ0EsU0FBSyxPQUFMLEdBQWUsQ0FBQyxDQUFDLE1BQU0sS0FBSyxVQUFMLENBQWdCLElBQWhCLENBQXFCLG1CQUFyQixDQUFQLENBQWhCO0FBQ0EsU0FBSyxjQUFMLEdBQXNCLEtBQUssT0FBTCxDQUFhLElBQWIsQ0FBa0IsV0FBbEIsS0FBa0MsY0FBeEQ7QUFFQTs7QUFDQSxRQUFJLE9BQU8sR0FBRyxLQUFLLFVBQUwsQ0FBZ0IsSUFBaEIsQ0FBcUIsU0FBckIsQ0FBZDs7QUFDQSxTQUFLLFFBQUwsR0FBaUIsT0FBRCxHQUFZLFFBQVEsQ0FBQyxjQUFULENBQXdCLE9BQXhCLENBQVosR0FBK0MsU0FBL0Q7QUFFQTs7QUFDQSxTQUFLLE1BQUwsR0FBYyxFQUFkO0FBQ0Es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Qm9CLEcsRUFBSztBQUN0QixVQUFJLENBQUMsR0FBRyxFQUFSOztBQUNBLFVBQUksT0FBTyxHQUFQLEtBQWUsUUFBbkIsRUFBNkI7QUFDekIsUUFBQSxHQUFHLEdBQUcsR0FBRyxDQUFDLElBQUosRUFBTjs7QUFDQSxZQUFJLEdBQUcsSUFBSSxFQUFYLEVBQWU7QUFDWCxVQUFBLENBQUMsR0FBSSxHQUFHLENBQUMsT0FBSixDQUFZLEdBQVosSUFBbUIsQ0FBQyxDQUFyQixHQUEwQixHQUFHLENBQUMsS0FBSixDQUFVLEdBQVYsQ0FBMUIsR0FBMkMsR0FBRyxDQUFDLEtBQUosQ0FBVSxHQUFWLENBQS9DOztBQUNBLGVBQUssSUFBSSxDQUFDLEdBQUMsQ0FBWCxFQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBcEIsRUFBNEIsQ0FBQyxFQUE3QjtBQUFpQyxZQUFBLENBQUMsQ0FBQyxDQUFELENBQUQsR0FBTyxDQUFDLENBQUMsQ0FBRCxDQUFELENBQUssSUFBTCxFQUFQO0FBQWpDO0FBQ0g7QUFDSjs7QUFDRCxhQUFPLENBQVA7QUFDSDs7OztLQWlCTDtBQUNBOzs7O0FBRUEsSUFBSSxXQUFXLEdBQUcsRUFBbEI7QUFDQSxDQUFDLENBQUMsUUFBRCxDQUFELENBQVksS0FBWixDQUFrQixZQUFNO0FBQ3BCLEVBQUEsT0FBTyxDQUFDLFFBQVIsQ0FBaUIsUUFBUSxDQUFDLElBQTFCO0FBQ0EsRUFBQSxDQUFDLENBQUMsTUFBTSxhQUFOLEdBQXNCLEdBQXZCLENBQUQsQ0FBNkIsSUFBN0IsQ0FBa0MsVUFBQyxLQUFELEVBQVEsSUFBUixFQUFpQjtBQUMvQyxJQUFBLFdBQVcsQ0FBQyxJQUFaLENBQWlCLElBQUksU0FBSixDQUFjLElBQWQsQ0FBakI7QUFDSCxHQUZEO0FBR0gsQ0FMRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vIE9GRi1DQU5WQVNcclxuLy8gPT09PT09PT09PVxyXG5cclxuY29uc3QgYXR0ckNsb3NlICAgICAgICAgICA9ICdkYXRhLWNsb3NlJztcclxuY29uc3QgYXR0ck9mZkNhbnZhcyAgICAgICA9ICdkYXRhLW9mZi1jYW52YXMnO1xyXG5jb25zdCBhdHRyT2ZmQ2FudmFzQnV0dG9uID0gJ2RhdGEtb2ZmLWNhbnZhcy1idXR0b24nO1xyXG5jb25zdCBhdHRyT2ZmQ2FudmFzTG9jayAgID0gJ2RhdGEtb2ZmLWNhbnZhcy1sb2NrJztcclxuY29uc3QgYXR0clRvZ2dsZXIgICAgICAgICA9ICdkYXRhLXRvZ2dsZXInO1xyXG5jb25zdCBvdmVybGF5ICAgICAgICAgICAgID0gJCgnPGRpdiBjbGFzcz1cImNhbnZhcy1vdmVybGF5XCI+PC9kaXY+Jyk7XHJcbmNvbnN0IHRvZ2dsZXJDbG9zZWQgICAgICAgPSAnaXMtY2xvc2VkJztcclxuY29uc3QgdG9nZ2xlckRlZmF1bHQgICAgICA9ICdpcy1hY3RpdmUnO1xyXG5jb25zdCB0b2dnbGVyTG9ja2VkICAgICAgID0gJ2lzLWxvY2tlZCc7XHJcbmNvbnN0IHRvZ2dsZXJOb0FuaW0gICAgICAgPSAnbm8tYW5pbSc7XHJcbmNvbnN0IHRvZ2dsZXJPcGVuICAgICAgICAgPSAnaXMtb3Blbic7XHJcbmNvbnN0IHRvZ2dsZXJWaXNpYmxlICAgICAgPSAnaXMtdmlzaWJsZSc7XHJcblxyXG4vLyBPZmYtQ2FudmFzXHJcbi8vIC0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9mZkNhbnZhcyB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XHJcbiAgICAgICAgLyogSW5pdGlhbGl6ZSAqL1xyXG4gICAgICAgIHRoaXMuX29mZkNhbnZhcyA9ICQoZWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gJCgnIycgKyB0aGlzLl9vZmZDYW52YXMuYXR0cihhdHRyT2ZmQ2FudmFzQnV0dG9uKSk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uVG9nZ2xlciA9IHRoaXMuX2J1dHRvbi5hdHRyKGF0dHJUb2dnbGVyKSB8fCB0b2dnbGVyRGVmYXVsdDtcclxuXHJcbiAgICAgICAgLyogSW5pdGlhbGl6ZSBvYmplY3QgdG8gY2xvc2UgKi9cclxuICAgICAgICBsZXQgY2xvc2VJZCA9IHRoaXMuX29mZkNhbnZhcy5hdHRyKGF0dHJDbG9zZSk7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VFbCA9IChjbG9zZUlkKSA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNsb3NlSWQpIDogdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICAvKiBMb2NrcyAqL1xyXG4gICAgICAgIHRoaXMuX2xvY2tzID0gW11cclxuICAgICAgICBsZXQgbG9ja0lkcyA9IE9mZkNhbnZhcy5zdHJpbmdUb0FycmF5KHRoaXMuX29mZkNhbnZhcy5hdHRyKGF0dHJPZmZDYW52YXNMb2NrKSk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NrSWRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvY2tzLnB1c2goJCgnIycgKyBsb2NrSWRzW2ldKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBSZWZyZXNoICovXHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcblxyXG4gICAgICAgIC8qIEF0dGFjaCBtZXRob2RzIHRvIHRoZSBET00gRWxlbWVudCBvZiB0aGlzIG9mZi1jYW52YXMgKi9cclxuICAgICAgICBlbGVtZW50LmNsb3NlID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIGVsZW1lbnQub3BlbiA9IHRoaXMub3Blbi5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICAvKiBFdmVudHMgKi9cclxuICAgICAgICAkKHdpbmRvdykucmVzaXplKChlKSA9PiB7IHRoaXMub25SZXNpemUoZSkgfSk7XHJcbiAgICAgICAgb3ZlcmxheS5vbignY2xpY2snLCAoZSkgPT4geyB0aGlzLm9uT3ZlcmxheUNsaWNrKGUpIH0pO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5vbignY2xpY2snLCAoZSkgPT4geyB0aGlzLm9uQnV0dG9uQ2xpY2soZSkgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy50b2dnbGUoZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQnV0dG9uQ2xpY2soZSkge1xyXG4gICAgICAgIHRoaXMuX29mZkNhbnZhcy5yZW1vdmVDbGFzcyh0b2dnbGVyTm9BbmltKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uT3ZlcmxheUNsaWNrKGUpIHtcclxuICAgICAgICB0aGlzLnRvZ2dsZShmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25SZXNpemUoZSkge1xyXG4gICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMudG9nZ2xlKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgdGhpcy5fb2ZmQ2FudmFzLmFkZENsYXNzKHRvZ2dsZXJOb0FuaW0pO1xyXG4gICAgICAgIGxldCBpc0J1dHRvblZpc2libGUgPSB0aGlzLl9idXR0b24uaXMoJzp2aXNpYmxlJyk7XHJcbiAgICAgICAgaWYgKGlzQnV0dG9uVmlzaWJsZSAhPSB0aGlzLl9pc0J1dHRvblZpc2libGUpIHsgLy8gU3RhdGUgY2hhbmdlZFxyXG4gICAgICAgICAgICB0aGlzLl9vZmZDYW52YXMudG9nZ2xlQ2xhc3ModG9nZ2xlckRlZmF1bHQsIGlzQnV0dG9uVmlzaWJsZSk7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlKGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy5faXNCdXR0b25WaXNpYmxlID0gaXNCdXR0b25WaXNpYmxlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgc3RyaW5nVG9BcnJheShzdHIpIHtcclxuICAgICAgICBsZXQgYSA9IFtdO1xyXG4gICAgICAgIGlmICh0eXBlb2Ygc3RyID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBzdHIgPSBzdHIudHJpbSgpO1xyXG4gICAgICAgICAgICBpZiAoc3RyICE9ICcnKSB7XHJcbiAgICAgICAgICAgICAgICBhID0gKHN0ci5pbmRleE9mKCcsJykgPiAtMSkgPyBzdHIuc3BsaXQoLywvKSA6IHN0ci5zcGxpdCgvIC8pO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaT0wOyBpIDwgYS5sZW5naHQ7IGkrKykgYVtpXSA9IGFbaV0udHJpbSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZShzdGF0ZSkge1xyXG4gICAgICAgIGlmIChzdGF0ZSA9PSB1bmRlZmluZWQpIHN0YXRlID0gIXRoaXMuX29mZkNhbnZhcy5oYXNDbGFzcyh0b2dnbGVyT3Blbik7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLnRvZ2dsZUNsYXNzKHRoaXMuX2J1dHRvblRvZ2dsZXIsIHN0YXRlKTtcclxuICAgICAgICB0aGlzLl9vZmZDYW52YXMudG9nZ2xlQ2xhc3ModG9nZ2xlck9wZW4sIHN0YXRlKTtcclxuICAgICAgICB0aGlzLl9vZmZDYW52YXMudG9nZ2xlQ2xhc3ModG9nZ2xlckNsb3NlZCwgIXN0YXRlKTtcclxuICAgICAgICBvdmVybGF5LnRvZ2dsZUNsYXNzKHRvZ2dsZXJWaXNpYmxlLCBzdGF0ZSk7XHJcbiAgICAgICAgaWYgKHN0YXRlICYmIHRoaXMuX2Nsb3NlRWwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Nsb3NlRWwuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9sb2Nrcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9sb2Nrc1tpXS50b2dnbGVDbGFzcyh0b2dnbGVyTG9ja2VkLCBzdGF0ZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEluaXRpYWxpemUgY2FudmFzIG92ZXJsYXkgYW5kIGVsZW1lbnRzIHdpdGggJ2RhdGEtb2ZmLWNhbnZhcycgYXR0cmlidXRlXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5sZXQgb2ZmQ2FudmFzZXMgPSBbXTtcclxuJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xyXG4gICAgb3ZlcmxheS5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KTtcclxuICAgICQoJ1snICsgYXR0ck9mZkNhbnZhcyArICddJykuZWFjaCgoaW5kZXgsIGl0ZW0pID0+IHtcclxuICAgICAgICBvZmZDYW52YXNlcy5wdXNoKG5ldyBPZmZDYW52YXMoaXRlbSkpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXX0="}